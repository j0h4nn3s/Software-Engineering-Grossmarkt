function ajax(t,e,u,n){var r=new XMLHttpRequest,d="GET"==t?"GET":"POST";r.open(d,"php/"+t+"_"+e+".php"),r.onreadystatechange=function(){4===r.readyState&&(200===r.status?void 0!==n&&n(r.responseText):alert("Fehler "+r.status+" ist aufgetreten.\n\nBitte wenden Sie sich an Ihren IT-Support."))},"POST"==d?(r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.send(u)):r.send()}function getProducts(){ajax("GET","products",null,createProductList)}function getProducers(){ajax("GET","producers",null,createExternalList)}function getSuppliers(){ajax("GET","suppliers",null,createExternalList)}function getCategorySelect(){ajax("GET","categories",null,createCategorySelect)}function getProducerSelect(){ajax("GET","producers",null,createProducerSelect)}function getSupplierSelect(){ajax("GET","suppliers",null,createSupplierSelect)}function createProductList(t){var e=JSON.parse(t),u="";e.forEach(function(t){u+='<tr data-id="'+t.id+'" data-name="'+t.name+'" data-amount="'+t.amount+'" data-category-id="'+t.category_id+'" data-category-name="'+t.category_name+'" data-origin="'+t.origin+'" data-bbd="'+t.bbd+'" data-supplier-id="'+t.supplier_id+'" data-supplier-name="'+t.supplier_name+'" data-producer-id="'+t.producer_id+'" data-producer-name="'+t.producer_name+'" data-buying="'+t.buying_price+'" data-selling="'+t.selling_price+'" class="table-list-row"><td>'+t.name+"</td><td>"+t.amount+" kg</td><td>"+t.category_name+"</td><td>"+t.buying_price+" €</td><td>"+t.selling_price+" €</td><td>"+(1e5+parseInt(t.id))+"</td></tr>"}),$tableListBody.innerHTML=u;for(var n=document.getElementsByClassName("table-list-row"),r=n.length,d=0;r>d;d++)n[d].addEventListener("click",function(){$productNameOutput.dataset.id=this.dataset.id,$productNameOutput.innerHTML=this.dataset.name,$productAmountOutput.innerHTML=this.dataset.amount,$productCategoryOutput.dataset.id=this.dataset.categoryId,$productCategoryOutput.innerHTML=this.dataset.categoryName,$productOriginOutput.innerHTML=this.dataset.origin,$productBbdOutput.innerHTML=this.dataset.bbd,$productProducerOutput.dataset.id=this.dataset.producerId,$productProducerOutput.innerHTML=this.dataset.producerName,$productSupplierOutput.dataset.id=this.dataset.supplierId,$productSupplierOutput.innerHTML=this.dataset.supplierName,$productBuyingOutput.innerHTML=this.dataset.buying,$productSellingOutput.innerHTML=this.dataset.selling,modal.set("view"),modal.toggle()})}function createExternalList(t){var e=JSON.parse(t),u="";e.forEach(function(t){u+='<tr data-id="'+t.id+'" data-name="'+t.name+'" data-street="'+t.street+'" data-zip="'+t.zip_code+'" data-town="'+t.town+'" data-country="'+t.country+'" class="table-list-row"><td>'+t.name+"</td><td>"+t.street+"</td><td>"+t.zip_code+"</td><td>"+t.town+"</td><td>"+t.country+"</td></tr>"}),$tableListBody.innerHTML=u;for(var n=document.getElementsByClassName("table-list-row"),r=n.length,d=0;r>d;d++)n[d].addEventListener("click",function(){$externalNameOutput.dataset.id=this.dataset.id,$externalNameOutput.innerHTML=this.dataset.name,$externalStreetOutput.innerHTML=this.dataset.street,$externalZipOutput.innerHTML=this.dataset.zip,$externalTownOutput.innerHTML=this.dataset.town,$externalCountryOutput.innerHTML=this.dataset.country,modal.set("view"),modal.toggle()})}function createCategorySelect(t){var e=JSON.parse(t),u='<option value="0">Auswählen ...</option>';e.forEach(function(t){u+='<option value="'+t.id+'">'+t.name+"</option>"}),$productCategoryInput.innerHTML=u}function createProducerSelect(t){var e=JSON.parse(t),u='<option value="0">Auswählen ...</option>';e.forEach(function(t){u+='<option value="'+t.id+'">'+t.name+"</option>"}),$productProducerInput.innerHTML=u}function createSupplierSelect(t){var e=JSON.parse(t),u='<option value="0">Auswählen ...</option>';e.forEach(function(t){u+='<option value="'+t.id+'">'+t.name+"</option>"}),$productSupplierInput.innerHTML=u}var site=document.body.dataset.page,$container=document.getElementById("container"),$tableListBody=document.getElementById("table-list-body"),$modal=document.getElementById("modal"),$productNameInput=document.getElementById("product-name-input"),$productNameOutput=document.getElementById("product-name-output"),$productAmountInput=document.getElementById("product-amount-input"),$productAmountOutput=document.getElementById("product-amount-output"),$productCategoryInput=document.getElementById("product-category-input"),$productCategoryOutput=document.getElementById("product-category-output"),$productOriginInput=document.getElementById("product-origin-input"),$productOriginOutput=document.getElementById("product-origin-output"),$productBbdInput=document.getElementById("product-bbd-input"),$productBbdOutput=document.getElementById("product-bbd-output"),$productProducerInput=document.getElementById("product-producer-input"),$productProducerOutput=document.getElementById("product-producer-output"),$productSupplierInput=document.getElementById("product-supplier-input"),$productSupplierOutput=document.getElementById("product-supplier-output"),$productBuyingInput=document.getElementById("product-buying-input"),$productBuyingOutput=document.getElementById("product-buying-output"),$productSellingInput=document.getElementById("product-selling-input"),$productSellingOutput=document.getElementById("product-selling-output"),$externalNameInput=document.getElementById("external-name-input"),$externalNameOutput=document.getElementById("external-name-output"),$externalStreetInput=document.getElementById("external-street-input"),$externalStreetOutput=document.getElementById("external-street-output"),$externalZipInput=document.getElementById("external-zip-input"),$externalZipOutput=document.getElementById("external-zip-output"),$externalTownInput=document.getElementById("external-town-input"),$externalTownOutput=document.getElementById("external-town-output"),$externalCountryInput=document.getElementById("external-country-input"),$externalCountryOutput=document.getElementById("external-country-output");document.getElementById("navbar-user-info").addEventListener("click",function(){this.classList.toggle("active")});var modal=function(){var t=document.getElementById("btn-modal-close"),e=document.getElementById("btn-modal-edit"),u=document.getElementById("btn-modal-edit-cancel"),n=document.getElementById("btn-modal-edit-save"),r=document.getElementById("btn-modal-delete"),d=document.getElementById("btn-modal-delete-cancel"),a=document.getElementById("btn-modal-delete-confirm"),o=document.getElementById("btn-add"),p=document.getElementById("btn-modal-new-cancel"),i=document.getElementById("btn-modal-new-save"),c=function(){t.addEventListener("click",l),e.addEventListener("click",function(){s("edit")}),u.addEventListener("click",function(){s("view")}),n.addEventListener("click",function(){I(),$(),s("view")}),r.addEventListener("click",function(){s("delete")}),d.addEventListener("click",function(){s("view")}),a.addEventListener("click",function(){y(),l()}),o.addEventListener("click",function(){s("new"),l()}),p.addEventListener("click",function(){l()}),i.addEventListener("click",function(){v(),l()})},l=function(){$container.classList.toggle("blur"),$modal.classList.toggle("visible")},s=function(t){"view"==t?($modal.classList.add("view"),$modal.classList.remove("edit"),$modal.classList.remove("new"),$modal.classList.remove("delete")):"edit"==t?(m(site),$modal.classList.add("edit"),$modal.classList.remove("view")):"new"==t?(g(),$modal.classList.add("new"),$modal.classList.remove("view")):$modal.classList.add("delete")},m=function(){"products"==site?($productNameInput.dataset.id=$productNameOutput.dataset.id,$productNameInput.value=$productNameOutput.innerHTML,$productAmountInput.value=$productAmountOutput.innerHTML,$productCategoryInput.value=$productCategoryOutput.dataset.id,$productOriginInput.value=$productOriginOutput.innerHTML,$productBbdInput.value=$productBbdOutput.innerHTML,$productProducerInput.value=$productProducerOutput.dataset.id,$productSupplierInput.value=$productSupplierOutput.dataset.id,$productBuyingInput.value=$productBuyingOutput.innerHTML,$productSellingInput.value=$productSellingOutput.innerHTML):($externalNameInput.dataset.id=$externalNameOutput.dataset.id,$externalNameInput.value=$externalNameOutput.innerHTML,$externalStreetInput.value=$externalStreetOutput.innerHTML,$externalZipInput.value=$externalZipOutput.innerHTML,$externalTownInput.value=$externalTownOutput.innerHTML,$externalCountryInput.value=$externalCountryOutput.innerHTML)},$=function(){"products"==site?($productNameOutput.innerHTML=$productNameInput.value,$productAmountOutput.innerHTML=$productAmountInput.value,$productCategoryOutput.dataset.id=$productCategoryInput.options[$productCategoryInput.selectedIndex].value,$productCategoryOutput.innerHTML=$productCategoryInput.options[$productCategoryInput.selectedIndex].text,$productOriginOutput.innerHTML=$productOriginInput.value,$productBbdOutput.innerHTML=$productBbdInput.value,$productProducerOutput.dataset.id=$productProducerInput.options[$productProducerInput.selectedIndex].value,$productProducerOutput.innerHTML=$productProducerInput.options[$productProducerInput.selectedIndex].text,$productSupplierOutput.dataset.id=$productSupplierInput.options[$productSupplierInput.selectedIndex].value,$productSupplierOutput.innerHTML=$productSupplierInput.options[$productSupplierInput.selectedIndex].text,$productBuyingOutput.innerHTML=$productBuyingInput.value,$productSellingOutput.innerHTML=$productSellingInput.value):($externalNameOutput.innerHTML=$externalNameInput.value,$externalStreetOutput.innerHTML=$externalStreetInput.value,$externalZipOutput.innerHTML=$externalZipInput.value,$externalTownOutput.innerHTML=$externalTownInput.value,$externalCountryOutput.innerHTML=$externalCountryInput.value)},g=function(){"products"==site?($productNameInput.value="",$productAmountInput.value="",$productCategoryInput.value=0,$productOriginInput.value="",$productBbdInput.value="",$productProducerInput.value=0,$productSupplierInput.value=0,$productBuyingInput.value="",$productSellingInput.value=""):($externalNameInput.value="",$externalStreetInput.value="",$externalZipInput.value="",$externalTownInput.value="",$externalCountryInput.value="")},I=function(){var t;"products"==site?(t="id="+$productNameInput.dataset.id+"&name="+$productNameInput.value+"&amount="+$productAmountInput.value+"&category="+$productCategoryInput.options[$productCategoryInput.selectedIndex].value+"&origin="+$productOriginInput.value+"&bbd="+$productBbdInput.value+"&producer="+$productProducerInput.options[$productProducerInput.selectedIndex].value+"&supplier="+$productSupplierInput.options[$productSupplierInput.selectedIndex].value+"&selling="+$productSellingInput.value+"&buying="+$productBuyingInput.value,ajax("UPDATE","product",t,function(){getProducts()})):(t="id="+$externalNameInput.dataset.id+"&name="+$externalNameInput.value+"&street="+$externalStreetInput.value+"&zip="+$externalZipInput.value+"&town="+$externalTownInput.value+"&country="+$externalCountryInput.value,"producers"==site?ajax("UPDATE","producer",t,function(){getProducers()}):ajax("UPDATE","supplier",t,function(){getSuppliers()}))},v=function(){var t;"products"==site?(t="&name="+$productNameInput.value+"&amount="+$productAmountInput.value+"&category="+$productCategoryInput.options[$productCategoryInput.selectedIndex].value+"&origin="+$productOriginInput.value+"&bbd="+$productBbdInput.value+"&producer="+$productProducerInput.options[$productProducerInput.selectedIndex].value+"&supplier="+$productSupplierInput.options[$productSupplierInput.selectedIndex].value+"&selling="+$productSellingInput.value+"&buying="+$productBuyingInput.value,ajax("CREATE","product",t,function(){getProducts()})):(t="name="+$externalNameInput.value+"&street="+$externalStreetInput.value+"&zip="+$externalZipInput.value+"&town="+$externalTownInput.value+"&country="+$externalCountryInput.value,"producers"==site?ajax("CREATE","producer",t,function(){getProducers()}):ajax("CREATE","supplier",t,function(){getSuppliers()}))},y=function(){var t;"products"==site?(t="id="+$productNameOutput.dataset.id,ajax("DELETE","product",t,function(){getProducts()})):(t="id="+$externalNameOutput.dataset.id,"producers"==site?ajax("DELETE","producer",t,function(){getProducers()}):ajax("DELETE","supplier",t,function(){getSuppliers()}))};return{init:c,toggle:l,set:s}}();switch(site){case"products":modal.init(),getProducts(),getCategorySelect(),getProducerSelect(),getSupplierSelect();break;case"producers":modal.init(),getProducers();break;case"suppliers":modal.init(),getSuppliers()}